---
title: "Gulf Stream Width"
author: "B Tupper, J Evanilla"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Gulf Stream Width}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r}
suppressPackageStartupMessages({
  library(sf)
  library(dplyr)
  library(gstream)
  library(rnaturalearth)
})
coast = rnaturalearth::ne_coastline(scale = "medium", returnclass = "sf")

All = gstream::read_usn()
bb = sf::st_bbox(All)
x = All |>
  dplyr::slice_max(date)

west = -71
east = -61
north = 45
south = 32
BB = sf::st_bbox(c(xmin = west, ymin = south, xmax = east, ymax = north),
                 crs = sf::st_crs(All)) |>
  sf::st_as_sfc()



plot(x['wall'], pch = ".", axes = TRUE, reset = FALSE, extent = BB, key.pos = NULL)
plot(BB, add = TRUE)
plot(sf::st_geometry(coast), add = TRUE)
```


```{r}
z = st_crop(x, BB) |> order_usn()
p = st_cast(z, "POINT")

plot(z['wall'], reset = FALSE)
plot(p['wall'] |> dplyr::filter(wall == 'north') |> dplyr::slice(1), add = TRUE)
#plot(p['wall'] |> dplyr::filter(wall == 'south') |> dplyr::slice(1), add = TRUE)
```
